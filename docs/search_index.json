{"index":{"version":"0.5.12","fields":[{"name":"title","boost":10},{"name":"keywords","boost":15},{"name":"body","boost":1}],"ref":"url","documentStore":{"store":{"./":["gitbook","简介"],"concurrency/thundering_herd.html":["!=","(fd","(netfd","*netfd)","*netfd,","......","//fd添加到epoll队列中","1.","1.1.","1.2.","2.","3.","4.","4.5内核在epoll已经新增了epoll_exclusive选项，在多个进程同时监听同一个socket，只有一个被唤醒。","5.","6.",":=","=","==","_","accept","accept()","accept(fd.sysfd)","accept惊群","accept惊群1.1.","accept惊群的解决","accept惊群的解决2.","break","continu","defer","epoll惊群","epoll惊群3.","er","err","error)","event）。机器上运行着不等数量的服务进程或线程。这些进程监听着同一个socket。这个socket是和客户端通信的唯一地址。服务器父子进程或者多线程模型都accept该socket，有几率同时调用accept。当一个请求进来，accept同时唤醒等待socket的多个进程，但是只有一个进程能accept到新的socket，其他进程accept不到任何东西，只好继续回到accept流程。这就是惊群效应。如果使用的是select/epoll+accept，则把惊群提前到了select/epoll这一步，多个进程只有一个进程能acxept到连接，因为是非阻塞socket，其他进程返回eagain。","fd.family,","fd.net)","fd.pd.waitread();","fd.readlock();","fd.readunlock()","fd.sotype,","func","golang中惊群的解决","golang中惊群的解决6.","liunx","lsa,","mpm）或者n进程：m线程比例创建服务线程（比如nginx","netfd,","netfd.addrfunc()(rsa))","netfd.init()","netfd.setaddr(netfd.addrfunc()(lsa),","newfd(s,","nginx惊群","nginx惊群4.","nil","nil,","queue。reuse部分解决了惊群问题，但是本身存在一些缺点或bug，比如reuse实现是根据客户端ip端口实现哈希，对同一个客户请求哈希到同一个服务器进程，但是没有实现一致性哈希。在进程数量扩展新的进程，由于缺少一致性哈希，当listen","queue中。当一个tcp","queue只唤醒有请求的进程。协议栈将socket请求均匀分配给每个accept","queue的所有进程。所以修复linux内核的办法是只唤醒一个进程，比如说替换wake函数为wake_one_interruptoble()。","queue，假设在开启了socket","queue，每次唤醒wait","refer","reset，所以有些请求会握手失败。","return","reuse_port选项，内核中为每个进程分配了单独的accept","rsa,","s,","socket有io事件变化，都会产生一个wake_up_interruptible()。该系统调用会唤醒wait","socket的数目发生变化（比如新服务上线、已存在服务终止）的时候，根据so_reuseport的路由算法，在客户端和服务端正在进行三次握手的阶段，最终的ack可能不能正确送达到对应的socket，导致客户端连接发生connect","syscall.eagain","syscall.econnabort","syscall.getsockname(netfd.sysfd)","wait","{","}","传统的服务器使用“listen","创建通信socket”完成客户端的一次请求服务。在高并发服务模型中，服务器创建很多进程","单线程（比如apach","在一个高并发的服务器模型中，每秒accept的连接数很多。accept成为一个占用cpu很高的系统调用。考虑使用多进程来accept。select由于可扩展性能比如epoll，select遍历所有socket，select对每次操作都是要循环遍历所有的fd，所以在高并发场景下，select性能差。在高并发场景epoll使用场景更多。","惊群效应","惊群效应1.","所有监听同一个socket的进程在内核中中都会被放在这个socket的wait","服务器网络模型和惊群","服务器网络模型和惊群1.2.","没有开启reuse选项的socket只有一个wait","线程池惊群","线程池惊群5.","高并发中的惊群效应","／／tcp还没三次握手成功，阻塞读直到成功，同时调度控制权下放给gorontin","／／在这里序列化accept，避免惊群效应","／／被对端关闭"],"nginx/readme.html":["nginx"],"nginx/data.html":["radix","tree","数据结构"],"nginx/process.html":["执行流程"],"nginx/http.html":["http"]},"length":6},"tokenStore":{"root":{"1":{"docs":{},".":{"1":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"2":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"2":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"3":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"4":{"docs":{},".":{"5":{"docs":{},"内":{"docs":{},"核":{"docs":{},"在":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"已":{"docs":{},"经":{"docs":{},"新":{"docs":{},"增":{"docs":{},"了":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"_":{"docs":{},"e":{"docs":{},"x":{"docs":{},"c":{"docs":{},"l":{"docs":{},"u":{"docs":{},"s":{"docs":{},"i":{"docs":{},"v":{"docs":{},"e":{"docs":{},"选":{"docs":{},"项":{"docs":{},"，":{"docs":{},"在":{"docs":{},"多":{"docs":{},"个":{"docs":{},"进":{"docs":{},"程":{"docs":{},"同":{"docs":{},"时":{"docs":{},"监":{"docs":{},"听":{"docs":{},"同":{"docs":{},"一":{"docs":{},"个":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"，":{"docs":{},"只":{"docs":{},"有":{"docs":{},"一":{"docs":{},"个":{"docs":{},"被":{"docs":{},"唤":{"docs":{},"醒":{"docs":{},"。":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"5":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"6":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{},"g":{"docs":{},"i":{"docs":{},"t":{"docs":{},"b":{"docs":{},"o":{"docs":{},"o":{"docs":{},"k":{"docs":{"./":{"ref":"./","tf":1}}}}}}}},"o":{"docs":{},"l":{"docs":{},"a":{"docs":{},"n":{"docs":{},"g":{"docs":{},"中":{"docs":{},"惊":{"docs":{},"群":{"docs":{},"的":{"docs":{},"解":{"docs":{},"决":{"6":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}},"简":{"docs":{},"介":{"docs":{"./":{"ref":"./","tf":10}}}},"!":{"docs":{},"=":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.015037593984962405}}}},"(":{"docs":{},"f":{"docs":{},"d":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"n":{"docs":{},"e":{"docs":{},"t":{"docs":{},"f":{"docs":{},"d":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}},"*":{"docs":{},"n":{"docs":{},"e":{"docs":{},"t":{"docs":{},"f":{"docs":{},"d":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}},".":{"docs":{},".":{"docs":{},".":{"docs":{},".":{"docs":{},".":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.022556390977443608}}}}}}}},"/":{"docs":{},"/":{"docs":{},"f":{"docs":{},"d":{"docs":{},"添":{"docs":{},"加":{"docs":{},"到":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"队":{"docs":{},"列":{"docs":{},"中":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}},":":{"docs":{},"=":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.015037593984962405}}}},"=":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.03007518796992481}},"=":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.022556390977443608}}}},"_":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}},"(":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}},"f":{"docs":{},"d":{"docs":{},".":{"docs":{},"s":{"docs":{},"y":{"docs":{},"s":{"docs":{},"f":{"docs":{},"d":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}},"惊":{"docs":{},"群":{"1":{"docs":{},".":{"1":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}},"的":{"docs":{},"解":{"docs":{},"决":{"2":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}},"b":{"docs":{},"r":{"docs":{},"e":{"docs":{},"a":{"docs":{},"k":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}},"c":{"docs":{},"o":{"docs":{},"n":{"docs":{},"t":{"docs":{},"i":{"docs":{},"n":{"docs":{},"u":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.015037593984962405}}}}}}}}},"d":{"docs":{},"e":{"docs":{},"f":{"docs":{},"e":{"docs":{},"r":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"惊":{"docs":{},"群":{"3":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}},"r":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}},"r":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.08270676691729323}},"o":{"docs":{},"r":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}},"v":{"docs":{},"e":{"docs":{},"n":{"docs":{},"t":{"docs":{},"）":{"docs":{},"。":{"docs":{},"机":{"docs":{},"器":{"docs":{},"上":{"docs":{},"运":{"docs":{},"行":{"docs":{},"着":{"docs":{},"不":{"docs":{},"等":{"docs":{},"数":{"docs":{},"量":{"docs":{},"的":{"docs":{},"服":{"docs":{},"务":{"docs":{},"进":{"docs":{},"程":{"docs":{},"或":{"docs":{},"线":{"docs":{},"程":{"docs":{},"。":{"docs":{},"这":{"docs":{},"些":{"docs":{},"进":{"docs":{},"程":{"docs":{},"监":{"docs":{},"听":{"docs":{},"着":{"docs":{},"同":{"docs":{},"一":{"docs":{},"个":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"。":{"docs":{},"这":{"docs":{},"个":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"是":{"docs":{},"和":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"通":{"docs":{},"信":{"docs":{},"的":{"docs":{},"唯":{"docs":{},"一":{"docs":{},"地":{"docs":{},"址":{"docs":{},"。":{"docs":{},"服":{"docs":{},"务":{"docs":{},"器":{"docs":{},"父":{"docs":{},"子":{"docs":{},"进":{"docs":{},"程":{"docs":{},"或":{"docs":{},"者":{"docs":{},"多":{"docs":{},"线":{"docs":{},"程":{"docs":{},"模":{"docs":{},"型":{"docs":{},"都":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"该":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"，":{"docs":{},"有":{"docs":{},"几":{"docs":{},"率":{"docs":{},"同":{"docs":{},"时":{"docs":{},"调":{"docs":{},"用":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"。":{"docs":{},"当":{"docs":{},"一":{"docs":{},"个":{"docs":{},"请":{"docs":{},"求":{"docs":{},"进":{"docs":{},"来":{"docs":{},"，":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"同":{"docs":{},"时":{"docs":{},"唤":{"docs":{},"醒":{"docs":{},"等":{"docs":{},"待":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"的":{"docs":{},"多":{"docs":{},"个":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"但":{"docs":{},"是":{"docs":{},"只":{"docs":{},"有":{"docs":{},"一":{"docs":{},"个":{"docs":{},"进":{"docs":{},"程":{"docs":{},"能":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"到":{"docs":{},"新":{"docs":{},"的":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"，":{"docs":{},"其":{"docs":{},"他":{"docs":{},"进":{"docs":{},"程":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"不":{"docs":{},"到":{"docs":{},"任":{"docs":{},"何":{"docs":{},"东":{"docs":{},"西":{"docs":{},"，":{"docs":{},"只":{"docs":{},"好":{"docs":{},"继":{"docs":{},"续":{"docs":{},"回":{"docs":{},"到":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"流":{"docs":{},"程":{"docs":{},"。":{"docs":{},"这":{"docs":{},"就":{"docs":{},"是":{"docs":{},"惊":{"docs":{},"群":{"docs":{},"效":{"docs":{},"应":{"docs":{},"。":{"docs":{},"如":{"docs":{},"果":{"docs":{},"使":{"docs":{},"用":{"docs":{},"的":{"docs":{},"是":{"docs":{},"s":{"docs":{},"e":{"docs":{},"l":{"docs":{},"e":{"docs":{},"c":{"docs":{},"t":{"docs":{},"/":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"+":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"，":{"docs":{},"则":{"docs":{},"把":{"docs":{},"惊":{"docs":{},"群":{"docs":{},"提":{"docs":{},"前":{"docs":{},"到":{"docs":{},"了":{"docs":{},"s":{"docs":{},"e":{"docs":{},"l":{"docs":{},"e":{"docs":{},"c":{"docs":{},"t":{"docs":{},"/":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"这":{"docs":{},"一":{"docs":{},"步":{"docs":{},"，":{"docs":{},"多":{"docs":{},"个":{"docs":{},"进":{"docs":{},"程":{"docs":{},"只":{"docs":{},"有":{"docs":{},"一":{"docs":{},"个":{"docs":{},"进":{"docs":{},"程":{"docs":{},"能":{"docs":{},"a":{"docs":{},"c":{"docs":{},"x":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"到":{"docs":{},"连":{"docs":{},"接":{"docs":{},"，":{"docs":{},"因":{"docs":{},"为":{"docs":{},"是":{"docs":{},"非":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"，":{"docs":{},"其":{"docs":{},"他":{"docs":{},"进":{"docs":{},"程":{"docs":{},"返":{"docs":{},"回":{"docs":{},"e":{"docs":{},"a":{"docs":{},"g":{"docs":{},"a":{"docs":{},"i":{"docs":{},"n":{"docs":{},"。":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"f":{"docs":{},"d":{"docs":{},".":{"docs":{},"f":{"docs":{},"a":{"docs":{},"m":{"docs":{},"i":{"docs":{},"l":{"docs":{},"y":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}},"n":{"docs":{},"e":{"docs":{},"t":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}},"p":{"docs":{},"d":{"docs":{},".":{"docs":{},"w":{"docs":{},"a":{"docs":{},"i":{"docs":{},"t":{"docs":{},"r":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"(":{"docs":{},")":{"docs":{},";":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}},"r":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"l":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"(":{"docs":{},")":{"docs":{},";":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}},"u":{"docs":{},"n":{"docs":{},"l":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"(":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}},"s":{"docs":{},"o":{"docs":{},"t":{"docs":{},"y":{"docs":{},"p":{"docs":{},"e":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}},"u":{"docs":{},"n":{"docs":{},"c":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}},"l":{"docs":{},"i":{"docs":{},"u":{"docs":{},"n":{"docs":{},"x":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}},"s":{"docs":{},"a":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}},"m":{"docs":{},"p":{"docs":{},"m":{"docs":{},"）":{"docs":{},"或":{"docs":{},"者":{"docs":{},"n":{"docs":{},"进":{"docs":{},"程":{"docs":{},"：":{"docs":{},"m":{"docs":{},"线":{"docs":{},"程":{"docs":{},"比":{"docs":{},"例":{"docs":{},"创":{"docs":{},"建":{"docs":{},"服":{"docs":{},"务":{"docs":{},"线":{"docs":{},"程":{"docs":{},"（":{"docs":{},"比":{"docs":{},"如":{"docs":{},"n":{"docs":{},"g":{"docs":{},"i":{"docs":{},"n":{"docs":{},"x":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"n":{"docs":{},"e":{"docs":{},"t":{"docs":{},"f":{"docs":{},"d":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.015037593984962405}}},".":{"docs":{},"a":{"docs":{},"d":{"docs":{},"d":{"docs":{},"r":{"docs":{},"f":{"docs":{},"u":{"docs":{},"n":{"docs":{},"c":{"docs":{},"(":{"docs":{},")":{"docs":{},"(":{"docs":{},"r":{"docs":{},"s":{"docs":{},"a":{"docs":{},")":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}},"i":{"docs":{},"n":{"docs":{},"i":{"docs":{},"t":{"docs":{},"(":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}},"s":{"docs":{},"e":{"docs":{},"t":{"docs":{},"a":{"docs":{},"d":{"docs":{},"d":{"docs":{},"r":{"docs":{},"(":{"docs":{},"n":{"docs":{},"e":{"docs":{},"t":{"docs":{},"f":{"docs":{},"d":{"docs":{},".":{"docs":{},"a":{"docs":{},"d":{"docs":{},"d":{"docs":{},"r":{"docs":{},"f":{"docs":{},"u":{"docs":{},"n":{"docs":{},"c":{"docs":{},"(":{"docs":{},")":{"docs":{},"(":{"docs":{},"l":{"docs":{},"s":{"docs":{},"a":{"docs":{},")":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"w":{"docs":{},"f":{"docs":{},"d":{"docs":{},"(":{"docs":{},"s":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}},"g":{"docs":{},"i":{"docs":{},"n":{"docs":{},"x":{"docs":{"nginx/readme.html":{"ref":"nginx/readme.html","tf":10}},"惊":{"docs":{},"群":{"4":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}},"i":{"docs":{},"l":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.03007518796992481}},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}},"q":{"docs":{},"u":{"docs":{},"e":{"docs":{},"u":{"docs":{},"e":{"docs":{},"。":{"docs":{},"r":{"docs":{},"e":{"docs":{},"u":{"docs":{},"s":{"docs":{},"e":{"docs":{},"部":{"docs":{},"分":{"docs":{},"解":{"docs":{},"决":{"docs":{},"了":{"docs":{},"惊":{"docs":{},"群":{"docs":{},"问":{"docs":{},"题":{"docs":{},"，":{"docs":{},"但":{"docs":{},"是":{"docs":{},"本":{"docs":{},"身":{"docs":{},"存":{"docs":{},"在":{"docs":{},"一":{"docs":{},"些":{"docs":{},"缺":{"docs":{},"点":{"docs":{},"或":{"docs":{},"b":{"docs":{},"u":{"docs":{},"g":{"docs":{},"，":{"docs":{},"比":{"docs":{},"如":{"docs":{},"r":{"docs":{},"e":{"docs":{},"u":{"docs":{},"s":{"docs":{},"e":{"docs":{},"实":{"docs":{},"现":{"docs":{},"是":{"docs":{},"根":{"docs":{},"据":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"i":{"docs":{},"p":{"docs":{},"端":{"docs":{},"口":{"docs":{},"实":{"docs":{},"现":{"docs":{},"哈":{"docs":{},"希":{"docs":{},"，":{"docs":{},"对":{"docs":{},"同":{"docs":{},"一":{"docs":{},"个":{"docs":{},"客":{"docs":{},"户":{"docs":{},"请":{"docs":{},"求":{"docs":{},"哈":{"docs":{},"希":{"docs":{},"到":{"docs":{},"同":{"docs":{},"一":{"docs":{},"个":{"docs":{},"服":{"docs":{},"务":{"docs":{},"器":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"但":{"docs":{},"是":{"docs":{},"没":{"docs":{},"有":{"docs":{},"实":{"docs":{},"现":{"docs":{},"一":{"docs":{},"致":{"docs":{},"性":{"docs":{},"哈":{"docs":{},"希":{"docs":{},"。":{"docs":{},"在":{"docs":{},"进":{"docs":{},"程":{"docs":{},"数":{"docs":{},"量":{"docs":{},"扩":{"docs":{},"展":{"docs":{},"新":{"docs":{},"的":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"由":{"docs":{},"于":{"docs":{},"缺":{"docs":{},"少":{"docs":{},"一":{"docs":{},"致":{"docs":{},"性":{"docs":{},"哈":{"docs":{},"希":{"docs":{},"，":{"docs":{},"当":{"docs":{},"l":{"docs":{},"i":{"docs":{},"s":{"docs":{},"t":{"docs":{},"e":{"docs":{},"n":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"中":{"docs":{},"。":{"docs":{},"当":{"docs":{},"一":{"docs":{},"个":{"docs":{},"t":{"docs":{},"c":{"docs":{},"p":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}},"只":{"docs":{},"唤":{"docs":{},"醒":{"docs":{},"有":{"docs":{},"请":{"docs":{},"求":{"docs":{},"的":{"docs":{},"进":{"docs":{},"程":{"docs":{},"。":{"docs":{},"协":{"docs":{},"议":{"docs":{},"栈":{"docs":{},"将":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"请":{"docs":{},"求":{"docs":{},"均":{"docs":{},"匀":{"docs":{},"分":{"docs":{},"配":{"docs":{},"给":{"docs":{},"每":{"docs":{},"个":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"的":{"docs":{},"所":{"docs":{},"有":{"docs":{},"进":{"docs":{},"程":{"docs":{},"。":{"docs":{},"所":{"docs":{},"以":{"docs":{},"修":{"docs":{},"复":{"docs":{},"l":{"docs":{},"i":{"docs":{},"n":{"docs":{},"u":{"docs":{},"x":{"docs":{},"内":{"docs":{},"核":{"docs":{},"的":{"docs":{},"办":{"docs":{},"法":{"docs":{},"是":{"docs":{},"只":{"docs":{},"唤":{"docs":{},"醒":{"docs":{},"一":{"docs":{},"个":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"比":{"docs":{},"如":{"docs":{},"说":{"docs":{},"替":{"docs":{},"换":{"docs":{},"w":{"docs":{},"a":{"docs":{},"k":{"docs":{},"e":{"docs":{},"函":{"docs":{},"数":{"docs":{},"为":{"docs":{},"w":{"docs":{},"a":{"docs":{},"k":{"docs":{},"e":{"docs":{},"_":{"docs":{},"o":{"docs":{},"n":{"docs":{},"e":{"docs":{},"_":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"r":{"docs":{},"u":{"docs":{},"p":{"docs":{},"t":{"docs":{},"o":{"docs":{},"b":{"docs":{},"l":{"docs":{},"e":{"docs":{},"(":{"docs":{},")":{"docs":{},"。":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"，":{"docs":{},"假":{"docs":{},"设":{"docs":{},"在":{"docs":{},"开":{"docs":{},"启":{"docs":{},"了":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}},"每":{"docs":{},"次":{"docs":{},"唤":{"docs":{},"醒":{"docs":{},"w":{"docs":{},"a":{"docs":{},"i":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}},"r":{"docs":{},"e":{"docs":{},"f":{"docs":{},"e":{"docs":{},"r":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.015037593984962405}}}}},"s":{"docs":{},"e":{"docs":{},"t":{"docs":{},"，":{"docs":{},"所":{"docs":{},"以":{"docs":{},"有":{"docs":{},"些":{"docs":{},"请":{"docs":{},"求":{"docs":{},"会":{"docs":{},"握":{"docs":{},"手":{"docs":{},"失":{"docs":{},"败":{"docs":{},"。":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}},"t":{"docs":{},"u":{"docs":{},"r":{"docs":{},"n":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.015037593984962405}}}}}},"u":{"docs":{},"s":{"docs":{},"e":{"docs":{},"_":{"docs":{},"p":{"docs":{},"o":{"docs":{},"r":{"docs":{},"t":{"docs":{},"选":{"docs":{},"项":{"docs":{},"，":{"docs":{},"内":{"docs":{},"核":{"docs":{},"中":{"docs":{},"为":{"docs":{},"每":{"docs":{},"个":{"docs":{},"进":{"docs":{},"程":{"docs":{},"分":{"docs":{},"配":{"docs":{},"了":{"docs":{},"单":{"docs":{},"独":{"docs":{},"的":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"s":{"docs":{},"a":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}},"a":{"docs":{},"d":{"docs":{},"i":{"docs":{},"x":{"docs":{"nginx/data.html":{"ref":"nginx/data.html","tf":0.5}}}}}}},"s":{"docs":{},",":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"有":{"docs":{},"i":{"docs":{},"o":{"docs":{},"事":{"docs":{},"件":{"docs":{},"变":{"docs":{},"化":{"docs":{},"，":{"docs":{},"都":{"docs":{},"会":{"docs":{},"产":{"docs":{},"生":{"docs":{},"一":{"docs":{},"个":{"docs":{},"w":{"docs":{},"a":{"docs":{},"k":{"docs":{},"e":{"docs":{},"_":{"docs":{},"u":{"docs":{},"p":{"docs":{},"_":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"r":{"docs":{},"u":{"docs":{},"p":{"docs":{},"t":{"docs":{},"i":{"docs":{},"b":{"docs":{},"l":{"docs":{},"e":{"docs":{},"(":{"docs":{},")":{"docs":{},"。":{"docs":{},"该":{"docs":{},"系":{"docs":{},"统":{"docs":{},"调":{"docs":{},"用":{"docs":{},"会":{"docs":{},"唤":{"docs":{},"醒":{"docs":{},"w":{"docs":{},"a":{"docs":{},"i":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"的":{"docs":{},"数":{"docs":{},"目":{"docs":{},"发":{"docs":{},"生":{"docs":{},"变":{"docs":{},"化":{"docs":{},"（":{"docs":{},"比":{"docs":{},"如":{"docs":{},"新":{"docs":{},"服":{"docs":{},"务":{"docs":{},"上":{"docs":{},"线":{"docs":{},"、":{"docs":{},"已":{"docs":{},"存":{"docs":{},"在":{"docs":{},"服":{"docs":{},"务":{"docs":{},"终":{"docs":{},"止":{"docs":{},"）":{"docs":{},"的":{"docs":{},"时":{"docs":{},"候":{"docs":{},"，":{"docs":{},"根":{"docs":{},"据":{"docs":{},"s":{"docs":{},"o":{"docs":{},"_":{"docs":{},"r":{"docs":{},"e":{"docs":{},"u":{"docs":{},"s":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"r":{"docs":{},"t":{"docs":{},"的":{"docs":{},"路":{"docs":{},"由":{"docs":{},"算":{"docs":{},"法":{"docs":{},"，":{"docs":{},"在":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"和":{"docs":{},"服":{"docs":{},"务":{"docs":{},"端":{"docs":{},"正":{"docs":{},"在":{"docs":{},"进":{"docs":{},"行":{"docs":{},"三":{"docs":{},"次":{"docs":{},"握":{"docs":{},"手":{"docs":{},"的":{"docs":{},"阶":{"docs":{},"段":{"docs":{},"，":{"docs":{},"最":{"docs":{},"终":{"docs":{},"的":{"docs":{},"a":{"docs":{},"c":{"docs":{},"k":{"docs":{},"可":{"docs":{},"能":{"docs":{},"不":{"docs":{},"能":{"docs":{},"正":{"docs":{},"确":{"docs":{},"送":{"docs":{},"达":{"docs":{},"到":{"docs":{},"对":{"docs":{},"应":{"docs":{},"的":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"，":{"docs":{},"导":{"docs":{},"致":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"连":{"docs":{},"接":{"docs":{},"发":{"docs":{},"生":{"docs":{},"c":{"docs":{},"o":{"docs":{},"n":{"docs":{},"n":{"docs":{},"e":{"docs":{},"c":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"y":{"docs":{},"s":{"docs":{},"c":{"docs":{},"a":{"docs":{},"l":{"docs":{},"l":{"docs":{},".":{"docs":{},"e":{"docs":{},"a":{"docs":{},"g":{"docs":{},"a":{"docs":{},"i":{"docs":{},"n":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}},"c":{"docs":{},"o":{"docs":{},"n":{"docs":{},"n":{"docs":{},"a":{"docs":{},"b":{"docs":{},"o":{"docs":{},"r":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}},"g":{"docs":{},"e":{"docs":{},"t":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"n":{"docs":{},"a":{"docs":{},"m":{"docs":{},"e":{"docs":{},"(":{"docs":{},"n":{"docs":{},"e":{"docs":{},"t":{"docs":{},"f":{"docs":{},"d":{"docs":{},".":{"docs":{},"s":{"docs":{},"y":{"docs":{},"s":{"docs":{},"f":{"docs":{},"d":{"docs":{},")":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"w":{"docs":{},"a":{"docs":{},"i":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.015037593984962405}}}}}},"{":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.05263157894736842}}},"}":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.05263157894736842}}},"传":{"docs":{},"统":{"docs":{},"的":{"docs":{},"服":{"docs":{},"务":{"docs":{},"器":{"docs":{},"使":{"docs":{},"用":{"docs":{},"“":{"docs":{},"l":{"docs":{},"i":{"docs":{},"s":{"docs":{},"t":{"docs":{},"e":{"docs":{},"n":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}},"创":{"docs":{},"建":{"docs":{},"通":{"docs":{},"信":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"”":{"docs":{},"完":{"docs":{},"成":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"的":{"docs":{},"一":{"docs":{},"次":{"docs":{},"请":{"docs":{},"求":{"docs":{},"服":{"docs":{},"务":{"docs":{},"。":{"docs":{},"在":{"docs":{},"高":{"docs":{},"并":{"docs":{},"发":{"docs":{},"服":{"docs":{},"务":{"docs":{},"模":{"docs":{},"型":{"docs":{},"中":{"docs":{},"，":{"docs":{},"服":{"docs":{},"务":{"docs":{},"器":{"docs":{},"创":{"docs":{},"建":{"docs":{},"很":{"docs":{},"多":{"docs":{},"进":{"docs":{},"程":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"单":{"docs":{},"线":{"docs":{},"程":{"docs":{},"（":{"docs":{},"比":{"docs":{},"如":{"docs":{},"a":{"docs":{},"p":{"docs":{},"a":{"docs":{},"c":{"docs":{},"h":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}},"在":{"docs":{},"一":{"docs":{},"个":{"docs":{},"高":{"docs":{},"并":{"docs":{},"发":{"docs":{},"的":{"docs":{},"服":{"docs":{},"务":{"docs":{},"器":{"docs":{},"模":{"docs":{},"型":{"docs":{},"中":{"docs":{},"，":{"docs":{},"每":{"docs":{},"秒":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"的":{"docs":{},"连":{"docs":{},"接":{"docs":{},"数":{"docs":{},"很":{"docs":{},"多":{"docs":{},"。":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"成":{"docs":{},"为":{"docs":{},"一":{"docs":{},"个":{"docs":{},"占":{"docs":{},"用":{"docs":{},"c":{"docs":{},"p":{"docs":{},"u":{"docs":{},"很":{"docs":{},"高":{"docs":{},"的":{"docs":{},"系":{"docs":{},"统":{"docs":{},"调":{"docs":{},"用":{"docs":{},"。":{"docs":{},"考":{"docs":{},"虑":{"docs":{},"使":{"docs":{},"用":{"docs":{},"多":{"docs":{},"进":{"docs":{},"程":{"docs":{},"来":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"。":{"docs":{},"s":{"docs":{},"e":{"docs":{},"l":{"docs":{},"e":{"docs":{},"c":{"docs":{},"t":{"docs":{},"由":{"docs":{},"于":{"docs":{},"可":{"docs":{},"扩":{"docs":{},"展":{"docs":{},"性":{"docs":{},"能":{"docs":{},"比":{"docs":{},"如":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"，":{"docs":{},"s":{"docs":{},"e":{"docs":{},"l":{"docs":{},"e":{"docs":{},"c":{"docs":{},"t":{"docs":{},"遍":{"docs":{},"历":{"docs":{},"所":{"docs":{},"有":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"，":{"docs":{},"s":{"docs":{},"e":{"docs":{},"l":{"docs":{},"e":{"docs":{},"c":{"docs":{},"t":{"docs":{},"对":{"docs":{},"每":{"docs":{},"次":{"docs":{},"操":{"docs":{},"作":{"docs":{},"都":{"docs":{},"是":{"docs":{},"要":{"docs":{},"循":{"docs":{},"环":{"docs":{},"遍":{"docs":{},"历":{"docs":{},"所":{"docs":{},"有":{"docs":{},"的":{"docs":{},"f":{"docs":{},"d":{"docs":{},"，":{"docs":{},"所":{"docs":{},"以":{"docs":{},"在":{"docs":{},"高":{"docs":{},"并":{"docs":{},"发":{"docs":{},"场":{"docs":{},"景":{"docs":{},"下":{"docs":{},"，":{"docs":{},"s":{"docs":{},"e":{"docs":{},"l":{"docs":{},"e":{"docs":{},"c":{"docs":{},"t":{"docs":{},"性":{"docs":{},"能":{"docs":{},"差":{"docs":{},"。":{"docs":{},"在":{"docs":{},"高":{"docs":{},"并":{"docs":{},"发":{"docs":{},"场":{"docs":{},"景":{"docs":{},"e":{"docs":{},"p":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"使":{"docs":{},"用":{"docs":{},"场":{"docs":{},"景":{"docs":{},"更":{"docs":{},"多":{"docs":{},"。":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"惊":{"docs":{},"群":{"docs":{},"效":{"docs":{},"应":{"1":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":10.015037593984962}}}}}},"所":{"docs":{},"有":{"docs":{},"监":{"docs":{},"听":{"docs":{},"同":{"docs":{},"一":{"docs":{},"个":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"的":{"docs":{},"进":{"docs":{},"程":{"docs":{},"在":{"docs":{},"内":{"docs":{},"核":{"docs":{},"中":{"docs":{},"中":{"docs":{},"都":{"docs":{},"会":{"docs":{},"被":{"docs":{},"放":{"docs":{},"在":{"docs":{},"这":{"docs":{},"个":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"的":{"docs":{},"w":{"docs":{},"a":{"docs":{},"i":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"服":{"docs":{},"务":{"docs":{},"器":{"docs":{},"网":{"docs":{},"络":{"docs":{},"模":{"docs":{},"型":{"docs":{},"和":{"docs":{},"惊":{"docs":{},"群":{"1":{"docs":{},".":{"2":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}},"没":{"docs":{},"有":{"docs":{},"开":{"docs":{},"启":{"docs":{},"r":{"docs":{},"e":{"docs":{},"u":{"docs":{},"s":{"docs":{},"e":{"docs":{},"选":{"docs":{},"项":{"docs":{},"的":{"docs":{},"s":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"e":{"docs":{},"t":{"docs":{},"只":{"docs":{},"有":{"docs":{},"一":{"docs":{},"个":{"docs":{},"w":{"docs":{},"a":{"docs":{},"i":{"docs":{},"t":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}},"线":{"docs":{},"程":{"docs":{},"池":{"docs":{},"惊":{"docs":{},"群":{"5":{"docs":{},".":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}},"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}},"高":{"docs":{},"并":{"docs":{},"发":{"docs":{},"中":{"docs":{},"的":{"docs":{},"惊":{"docs":{},"群":{"docs":{},"效":{"docs":{},"应":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}},"／":{"docs":{},"／":{"docs":{},"t":{"docs":{},"c":{"docs":{},"p":{"docs":{},"还":{"docs":{},"没":{"docs":{},"三":{"docs":{},"次":{"docs":{},"握":{"docs":{},"手":{"docs":{},"成":{"docs":{},"功":{"docs":{},"，":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"读":{"docs":{},"直":{"docs":{},"到":{"docs":{},"成":{"docs":{},"功":{"docs":{},"，":{"docs":{},"同":{"docs":{},"时":{"docs":{},"调":{"docs":{},"度":{"docs":{},"控":{"docs":{},"制":{"docs":{},"权":{"docs":{},"下":{"docs":{},"放":{"docs":{},"给":{"docs":{},"g":{"docs":{},"o":{"docs":{},"r":{"docs":{},"o":{"docs":{},"n":{"docs":{},"t":{"docs":{},"i":{"docs":{},"n":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"在":{"docs":{},"这":{"docs":{},"里":{"docs":{},"序":{"docs":{},"列":{"docs":{},"化":{"docs":{},"a":{"docs":{},"c":{"docs":{},"c":{"docs":{},"e":{"docs":{},"p":{"docs":{},"t":{"docs":{},"，":{"docs":{},"避":{"docs":{},"免":{"docs":{},"惊":{"docs":{},"群":{"docs":{},"效":{"docs":{},"应":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}}}}}}}}}}}}}},"被":{"docs":{},"对":{"docs":{},"端":{"docs":{},"关":{"docs":{},"闭":{"docs":{"concurrency/thundering_herd.html":{"ref":"concurrency/thundering_herd.html","tf":0.007518796992481203}}}}}}}}},"t":{"docs":{},"r":{"docs":{},"e":{"docs":{},"e":{"docs":{"nginx/data.html":{"ref":"nginx/data.html","tf":0.5}}}}}},"数":{"docs":{},"据":{"docs":{},"结":{"docs":{},"构":{"docs":{"nginx/data.html":{"ref":"nginx/data.html","tf":10}}}}}},"执":{"docs":{},"行":{"docs":{},"流":{"docs":{},"程":{"docs":{"nginx/process.html":{"ref":"nginx/process.html","tf":10}}}}}},"h":{"docs":{},"t":{"docs":{},"t":{"docs":{},"p":{"docs":{"nginx/http.html":{"ref":"nginx/http.html","tf":10}}}}}}},"length":101},"corpusTokens":["!=","(fd","(netfd","*netfd)","*netfd,","......","//fd添加到epoll队列中","1.","1.1.","1.2.","2.","3.","4.","4.5内核在epoll已经新增了epoll_exclusive选项，在多个进程同时监听同一个socket，只有一个被唤醒。","5.","6.",":=","=","==","_","accept","accept()","accept(fd.sysfd)","accept惊群","accept惊群1.1.","accept惊群的解决","accept惊群的解决2.","break","continu","defer","epoll惊群","epoll惊群3.","er","err","error)","event）。机器上运行着不等数量的服务进程或线程。这些进程监听着同一个socket。这个socket是和客户端通信的唯一地址。服务器父子进程或者多线程模型都accept该socket，有几率同时调用accept。当一个请求进来，accept同时唤醒等待socket的多个进程，但是只有一个进程能accept到新的socket，其他进程accept不到任何东西，只好继续回到accept流程。这就是惊群效应。如果使用的是select/epoll+accept，则把惊群提前到了select/epoll这一步，多个进程只有一个进程能acxept到连接，因为是非阻塞socket，其他进程返回eagain。","fd.family,","fd.net)","fd.pd.waitread();","fd.readlock();","fd.readunlock()","fd.sotype,","func","gitbook","golang中惊群的解决","golang中惊群的解决6.","http","liunx","lsa,","mpm）或者n进程：m线程比例创建服务线程（比如nginx","netfd,","netfd.addrfunc()(rsa))","netfd.init()","netfd.setaddr(netfd.addrfunc()(lsa),","newfd(s,","nginx","nginx惊群","nginx惊群4.","nil","nil,","queue。reuse部分解决了惊群问题，但是本身存在一些缺点或bug，比如reuse实现是根据客户端ip端口实现哈希，对同一个客户请求哈希到同一个服务器进程，但是没有实现一致性哈希。在进程数量扩展新的进程，由于缺少一致性哈希，当listen","queue中。当一个tcp","queue只唤醒有请求的进程。协议栈将socket请求均匀分配给每个accept","queue的所有进程。所以修复linux内核的办法是只唤醒一个进程，比如说替换wake函数为wake_one_interruptoble()。","queue，假设在开启了socket","queue，每次唤醒wait","radix","refer","reset，所以有些请求会握手失败。","return","reuse_port选项，内核中为每个进程分配了单独的accept","rsa,","s,","socket有io事件变化，都会产生一个wake_up_interruptible()。该系统调用会唤醒wait","socket的数目发生变化（比如新服务上线、已存在服务终止）的时候，根据so_reuseport的路由算法，在客户端和服务端正在进行三次握手的阶段，最终的ack可能不能正确送达到对应的socket，导致客户端连接发生connect","syscall.eagain","syscall.econnabort","syscall.getsockname(netfd.sysfd)","tree","wait","{","}","传统的服务器使用“listen","创建通信socket”完成客户端的一次请求服务。在高并发服务模型中，服务器创建很多进程","单线程（比如apach","在一个高并发的服务器模型中，每秒accept的连接数很多。accept成为一个占用cpu很高的系统调用。考虑使用多进程来accept。select由于可扩展性能比如epoll，select遍历所有socket，select对每次操作都是要循环遍历所有的fd，所以在高并发场景下，select性能差。在高并发场景epoll使用场景更多。","惊群效应","惊群效应1.","所有监听同一个socket的进程在内核中中都会被放在这个socket的wait","执行流程","数据结构","服务器网络模型和惊群","服务器网络模型和惊群1.2.","没有开启reuse选项的socket只有一个wait","简介","线程池惊群","线程池惊群5.","高并发中的惊群效应","／／tcp还没三次握手成功，阻塞读直到成功，同时调度控制权下放给gorontin","／／在这里序列化accept，避免惊群效应","／／被对端关闭"],"pipeline":["stopWordFilter","stemmer"]},"store":{"./":{"url":"./","title":"简介","keywords":"","body":" gitbook gitbook\n"},"concurrency/thundering_herd.html":{"url":"concurrency/thundering_herd.html","title":"惊群效应","keywords":"","body":" 惊群效应1. accept惊群1.1. 服务器网络模型和惊群1.2. accept惊群的解决2. epoll惊群3. nginx惊群4. 线程池惊群5. golang中惊群的解决6. reference 惊群效应\n1. accept惊群\n1.1. 服务器网络模型和惊群\n传统的服务器使用“listen-accept-创建通信socket”完成客户端的一次请求服务。在高并发服务模型中，服务器创建很多进程-单线程（比如apache mpm）或者n进程：m线程比例创建服务线程（比如nginx event）。机器上运行着不等数量的服务进程或线程。这些进程监听着同一个socket。这个socket是和客户端通信的唯一地址。服务器父子进程或者多线程模型都accept该socket，有几率同时调用accept。当一个请求进来，accept同时唤醒等待socket的多个进程，但是只有一个进程能accept到新的socket，其他进程accept不到任何东西，只好继续回到accept流程。这就是惊群效应。如果使用的是select/epoll+accept，则把惊群提前到了select/epoll这一步，多个进程只有一个进程能acxept到连接，因为是非阻塞socket，其他进程返回EAGAIN。\n1.2. accept惊群的解决\n所有监听同一个socket的进程在内核中中都会被放在这个socket的wait queue中。当一个tcp socket有IO事件变化，都会产生一个wake_up_interruptible()。该系统调用会唤醒wait queue的所有进程。所以修复linux内核的办法是只唤醒一个进程，比如说替换wake函数为wake_one_interruptoble()。\n没有开启reuse选项的socket只有一个wait queue，假设在开启了socket REUSE_PORT选项，内核中为每个进程分配了单独的accept wait queue，每次唤醒wait queue只唤醒有请求的进程。协议栈将socket请求均匀分配给每个accept wait queue。reuse部分解决了惊群问题，但是本身存在一些缺点或bug，比如REUSE实现是根据客户端ip端口实现哈希，对同一个客户请求哈希到同一个服务器进程，但是没有实现一致性哈希。在进程数量扩展新的进程，由于缺少一致性哈希，当listen socket的数目发生变化（比如新服务上线、已存在服务终止）的时候，根据SO_REUSEPORT的路由算法，在客户端和服务端正在进行三次握手的阶段，最终的ACK可能不能正确送达到对应的socket，导致客户端连接发生Connection Reset，所以有些请求会握手失败。\n2. epoll惊群\n在一个高并发的服务器模型中，每秒accept的连接数很多。accept成为一个占用cpu很高的系统调用。考虑使用多进程来accept。select由于可扩展性能比如epoll，select遍历所有socket，select对每次操作都是要循环遍历所有的fd，所以在高并发场景下，select性能差。在高并发场景epoll使用场景更多。\nliunx 4.5内核在epoll已经新增了EPOLL_EXCLUSIVE选项，在多个进程同时监听同一个socket，只有一个被唤醒。\n3. nginx惊群\n4. 线程池惊群\n5. golang中惊群的解决\nfunc (fd *netFD) accept() (netfd *netFD, err error) {\n   ／／在这里序列化accept，避免惊群效应\n  if err := fd.readLock(); err != nil {\n        return nil, er\n    }\n    defer fd.readUnlock()\n    ......\n\n    for {\n        s, rsa, err = accept(fd.sysfd)\n        if err != nil {\n            if err == syscall.EAGAIN {\n                ／／tcp还没三次握手成功，阻塞读直到成功，同时调度控制权下放给gorontine\n                if err = fd.pd.WaitRead(); err == nil {\n                    continue\n                }\n            } else if err == syscall.ECONNABORTED {\n                ／／被对端关闭\n                continue\n            }\n        }\n        break\n    }\n\n    netfd, err = newFD(s, fd.family, fd.sotype, fd.net)\n    ......\n\n    //fd添加到epoll队列中\n    err = netfd.init()\n    ......\n    lsa, _ := syscall.Getsockname(netfd.sysfd)\n    netfd.setAddr(netfd.addrFunc()(lsa), netfd.addrFunc()(rsa))\n    return netfd, nil\n}\n\n6. reference\n高并发中的惊群效应\n惊群效应\n"},"nginx/readme.html":{"url":"nginx/readme.html","title":"nginx","keywords":"","body":""},"nginx/data.html":{"url":"nginx/data.html","title":"数据结构","keywords":"","body":"Radix tree\n"},"nginx/process.html":{"url":"nginx/process.html","title":"执行流程","keywords":"","body":""},"nginx/http.html":{"url":"nginx/http.html","title":"http","keywords":"","body":""}}}